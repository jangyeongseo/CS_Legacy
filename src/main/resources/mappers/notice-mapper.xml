<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "https://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="Notice">

	<!-- 공지사항 목록 조회 -->
	<select id="getAllNotices"
		resultType="com.kedu.notice.NoticeDTO">
		SELECT
			notice_seq,
			title,
			content,
			writer_email,
			company_code,
			view_count,
			created_at AS created_at
		FROM notice
		ORDER BY notice_seq DESC
	</select>
 
	<!-- 공지사항 상세 조회  -->
	<select id="selectNoticeById" parameterType="int"
		resultType="com.kedu.notice.NoticeDTO">
		SELECT
		notice_seq,
		view_count,
		title,
		content,
		company_code,
		writer_email,
		created_at AS created_at
		FROM notice
		WHERE notice_seq = #{notice_seq}
	</select>
	
	<!-- 조회수 증가 -->
	<update id="increaseViewCount" parameterType="int">
		UPDATE notice
		SET view_count = view_count + 1
		WHERE notice_seq = #{notice_seq}
	</update>

	<!-- 공지사항 삽입 -->
	<insert id="insertNotice"
		parameterType="com.kedu.notice.NoticeDTO">
		INSERT INTO notice (
			notice_seq,
			title,
			content,
			company_code,
			writer_email,
			created_at
		)
		VALUES (
			notice_seq.NEXTVAL,
			#{title,jdbcType=VARCHAR},
			#{content,jdbcType=CLOB},
			#{company_code,jdbcType=VARCHAR},
			#{writer_email,jdbcType=VARCHAR},
			SYSDATE
		)
	</insert>

	<!-- 공지사항 수정 -->
	<update id="updateNotice"
		parameterType="com.kedu.notice.NoticeDTO">
		UPDATE notice
		SET
		title = #{title,jdbcType=VARCHAR},
		content = #{content,jdbcType=CLOB},
		company_code = #{company_code,jdbcType=VARCHAR}
		WHERE notice_seq = #{notice_seq}
	</update>

	<!-- 공지사항 삭제 -->
	<delete id="deleteNotice" parameterType="int">
		DELETE FROM notice
		WHERE notice_seq = #{notice_seq}
	</delete>

	<!-- 전체 공지 개수 -->
	<select id="getNoticeCount" resultType="int">
		SELECT COUNT(*) FROM notice
	</select>

</mapper>
